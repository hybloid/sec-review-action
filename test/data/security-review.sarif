{"version":"2.1.0","$schema":"https://json.schemastore.org/sarif-2.1.0.json","runs":[{"tool":{"driver":{"name":"security-code-scanner","rules":[{"id":"TAINT.SQLi","name":"SQL Injection","shortDescription":{"text":"User-controlled data flows into SQL query without proper sanitization"}}]}},"results":[{"ruleId":"TAINT.SQLi","message":{"text":"User-controlled input from HTTP request header is concatenated directly into an SQL query without proper sanitization, allowing SQL injection attacks."},"level":"error","locations":[{"message":{"text":"SQL query constructed with unsanitized user input"},"physicalLocation":{"artifactLocation":{"uri":"src/main/java/org/example/TaintAnalysisExample.java"},"region":{"startLine":30,"startColumn":24,"endLine":30,"endColumn":79,"snippet":{"text":"String sql = \"SELECT available FROM products WHERE product_id='\" + aliasing.getX() + \"'\""}}}}],"codeFlows":[{"message":{"text":"Taint flow from user input to SQL query execution"},"threadFlows":[{"locations":[{"location":{"message":{"text":"User input from HTTP request header (source)"},"physicalLocation":{"artifactLocation":{"uri":"src/main/java/org/example/TaintAnalysisExample.java"},"region":{"startLine":16,"startColumn":9,"endLine":16,"endColumn":73,"snippet":{"text":"String productId = exc.getRequestHeaders().getFirst(\"productId\")"}}}},"kinds":["source"]},{"location":{"message":{"text":"Tainted value passed to checkIsProductAvailable method"},"physicalLocation":{"artifactLocation":{"uri":"src/main/java/org/example/TaintAnalysisExample.java"},"region":{"startLine":18,"startColumn":9,"endLine":18,"endColumn":48,"snippet":{"text":"if (checkIsProductAvailable(productId))"}}}},"kinds":["propagate"]},{"location":{"message":{"text":"Tainted value passed to Checker.checkIsSafe method"},"physicalLocation":{"artifactLocation":{"uri":"src/main/java/org/example/TaintAnalysisExample.java"},"region":{"startLine":26,"startColumn":9,"endLine":26,"endColumn":58,"snippet":{"text":"if (!Checker.checkIsSafe(productId)) return false"}}}},"kinds":["propagate"]},{"location":{"message":{"text":"Tainted value passed to Aliasing.setX method"},"physicalLocation":{"artifactLocation":{"uri":"src/main/java/org/example/TaintAnalysisExample.java"},"region":{"startLine":29,"startColumn":13,"endLine":29,"endColumn":37,"snippet":{"text":"aliasing.setX(productId)"}}}},"kinds":["propagate"]},{"location":{"message":{"text":"Tainted value stored in Aliasing.y field"},"physicalLocation":{"artifactLocation":{"uri":"src/main/java/org/example/Aliasing.java"},"region":{"startLine":8,"startColumn":9,"endLine":8,"endColumn":19,"snippet":{"text":"this.y = x"}}}},"kinds":["propagate"]},{"location":{"message":{"text":"Tainted value retrieved via Aliasing.getX method"},"physicalLocation":{"artifactLocation":{"uri":"src/main/java/org/example/TaintAnalysisExample.java"},"region":{"startLine":30,"startColumn":80,"endLine":30,"endColumn":95,"snippet":{"text":"aliasing.getX()"}}}},"kinds":["propagate"]},{"location":{"message":{"text":"Tainted value concatenated into SQL query (sink)"},"physicalLocation":{"artifactLocation":{"uri":"src/main/java/org/example/TaintAnalysisExample.java"},"region":{"startLine":30,"startColumn":13,"endLine":30,"endColumn":101,"snippet":{"text":"String sql = \"SELECT available FROM products WHERE product_id='\" + aliasing.getX() + \"'\""}}}},"kinds":["sink"]},{"location":{"message":{"text":"Tainted SQL query executed"},"physicalLocation":{"artifactLocation":{"uri":"src/main/java/org/example/TaintAnalysisExample.java"},"region":{"startLine":31,"startColumn":13,"endLine":31,"endColumn":40,"snippet":{"text":"statement.executeQuery(sql)"}}}},"kinds":["sink"]}]}]}],"properties":{"confidence":"0.9","vuln.kind":"taint","source.kind":"http.header","sink.kind":"sql.exec","tags":["security","sql-injection","cwe-89"]}}]}]}